{"ast":null,"code":"import _slicedToArray from\"C:/FullStackOpen/part2/phonebook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import Persons from\"./components/Persons\";import Filter from\"./components/Filter\";import PersonForm from\"./components/PersonForm\";import phonebookservice from\"../src/services/phonebookservice\";import Notification from\"../src/components/Notification\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),message=_useState10[0],setMessage=_useState10[1];useEffect(function(){phonebookservice.getAll().then(function(initialPeople){setPersons(initialPeople);}).catch(function(error){return console.log(\"GET error\",error.message);});},[]);var handleFilterChange=function handleFilterChange(event){console.log(\"filter\",event.target.value);setFilter(event.target.value);};var handleNameChange=function handleNameChange(event){console.log(event.target.value);setNewName(event.target.value);};var handleNumberChange=function handleNumberChange(event){console.log(event.target.value);setNewNumber(event.target.value);};var handleDeletePerson=function handleDeletePerson(id){var personToDelete=persons.filter(function(p){return p.id===id;});var nameToDelete=personToDelete[0].name;var idToDelete=personToDelete[0].id;if(window.confirm(\"Confirm to delete \".concat(nameToDelete,\" \").concat(idToDelete))){phonebookservice.deletePerson(idToDelete).then(function(response){return response.data;});setMessage(\"Deleted \".concat(nameToDelete));setPersons(persons.filter(function(person){return person.id!==idToDelete;}));}};var addPerson=function addPerson(event){event.preventDefault();var person={name:newName,number:newNumber};//console.log(\"new person\",person)\nvar names=persons.map(function(p){return p.name;});if(!names.includes(person.name)){setPersons(persons.concat(person));phonebookservice.create(person).then(function(np){setPersons(persons.concat(np));setNewName('');setMessage(\"Added \".concat(person.name));setTimeout(function(){setMessage(null);},5000);}).catch(function(error){setMessage(\"[error] \".concat(error.response.data.error));});}else if(window.confirm(\"\".concat(newName,\" is already added to phonebook, replace the old number with a new one?\"))){var personToUpdate=persons.find(function(p){return p.name===person.name;});//console.log(\"person to update\",personToUpdate)\nphonebookservice//.update(updatedPerson)\n.update(personToUpdate,newNumber).then(function(returnedPerson){console.log(\"successfully updated\",returnedPerson);setPersons(persons.map(function(p){return p.id!==person.id?p:returnedPerson;}));setMessage(\"Updated \".concat(returnedPerson.name,\"'s number to \").concat(returnedPerson.number));setNewName('');setNewNumber('');}).catch(function(error){setMessage(\"ERROR: \".concat(personToUpdate.name,\" was already removed from server\"));setTimeout(function(){setMessage(null);},5000);//setPersons(persons.filter(n => n.id !== personToUpdate.id))\n});}setNewName('');setNewNumber('');};console.log(\"people \",persons);var filteredpersons=persons.filter(function(p){return p.name.toLowerCase().includes(filter.toLowerCase());});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Notification,{message:message}),/*#__PURE__*/_jsx(Filter,{filter:filter,handleFilterChange:handleFilterChange}),/*#__PURE__*/_jsx(\"h3\",{children:\"add a new\"}),/*#__PURE__*/_jsx(PersonForm,{newName:newName,newNumber:newNumber,addPerson:addPerson,handleNameChange:handleNameChange,handleNumberChange:handleNumberChange}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{people:filteredpersons,handleDeletePerson:handleDeletePerson})]});};export default App;","map":{"version":3,"names":["useState","useEffect","Persons","Filter","PersonForm","phonebookservice","Notification","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filter","setFilter","message","setMessage","getAll","then","initialPeople","catch","error","console","log","handleFilterChange","event","target","value","handleNameChange","handleNumberChange","handleDeletePerson","id","personToDelete","p","nameToDelete","name","idToDelete","window","confirm","deletePerson","response","data","person","addPerson","preventDefault","number","names","map","includes","concat","create","np","setTimeout","personToUpdate","find","update","returnedPerson","filteredpersons","toLowerCase"],"sources":["C:/FullStackOpen/part2/phonebook/src/App.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport Persons from \"./components/Persons\";\r\nimport Filter from \"./components/Filter\";\r\nimport PersonForm from \"./components/PersonForm\";\r\nimport phonebookservice from \"../src/services/phonebookservice\"\r\nimport Notification from \"../src/components/Notification\";\r\nconst App = () => {\r\n  const [persons, setPersons] = useState([]) \r\n  const [newName, setNewName] = useState('')\r\n  const [newNumber, setNewNumber] = useState('')\r\n  const [filter, setFilter] = useState('')\r\n  const [message,setMessage] = useState(null)\r\n  useEffect(() =>{\r\n    phonebookservice\r\n      .getAll()\r\n      .then(initialPeople => {\r\n        setPersons(initialPeople)\r\n      })\r\n      .catch(error => console.log(\"GET error\",error.message))\r\n  },[])  \r\n\r\n  const handleFilterChange = (event) => {\r\n    console.log(\"filter\",event.target.value)\r\n    setFilter(event.target.value)\r\n  }\r\n   const handleNameChange = (event) => {\r\n    console.log(event.target.value)\r\n    setNewName(event.target.value)\r\n  }\r\n  const handleNumberChange = (event) => {\r\n    console.log(event.target.value)\r\n    setNewNumber(event.target.value)\r\n  }\r\n\r\n  const handleDeletePerson = (id) => {\r\n    let personToDelete = persons.filter(p => p.id === id)\r\n    let nameToDelete = personToDelete[0].name\r\n    let idToDelete = personToDelete[0].id\r\n    if(window.confirm(`Confirm to delete ${nameToDelete} ${idToDelete}`)) {\r\n      phonebookservice\r\n        .deletePerson(idToDelete)\r\n        .then(response => response.data)\r\n      setMessage(`Deleted ${nameToDelete}`)\r\n      setPersons(persons.filter(person => person.id !== idToDelete))\r\n    }\r\n  }\r\n\r\n  const addPerson = (event) => {\r\n    event.preventDefault()\r\n    const person = {\r\n      name: newName,\r\n      number: newNumber\r\n    }\r\n    //console.log(\"new person\",person)\r\n    let names = persons.map(p => p.name)\r\n    if(!names.includes(person.name)){\r\n      setPersons(persons.concat(person))\r\n      phonebookservice\r\n        .create(person)\r\n        .then(np => {\r\n          setPersons(persons.concat(np))\r\n          setNewName('')\r\n          setMessage(`Added ${person.name}`)\r\n          setTimeout(() => {\r\n            setMessage(null)\r\n          }, 5000)\r\n        })\r\n        .catch(error => {\r\n          setMessage(`[error] ${error.response.data.error}`)\r\n        })\r\n    }else if(window.confirm(`${newName} is already added to phonebook, replace the old number with a new one?`)){\r\n      let personToUpdate = persons.find(p => p.name === person.name)\r\n      //console.log(\"person to update\",personToUpdate)\r\n      phonebookservice\r\n        //.update(updatedPerson)\r\n        .update(personToUpdate,newNumber)\r\n        .then(returnedPerson => {\r\n          console.log(\"successfully updated\",returnedPerson)     \r\n          setPersons(persons.map(p=> p.id !== person.id ? p : returnedPerson))\r\n          setMessage(`Updated ${returnedPerson.name}'s number to ${returnedPerson.number}`)\r\n          setNewName('')\r\n          setNewNumber('')\r\n        }).catch(error => {\r\n          setMessage(\r\n            `ERROR: ${personToUpdate.name} was already removed from server`\r\n          )\r\n          setTimeout(() => {\r\n            setMessage(null)\r\n          }, 5000)\r\n          //setPersons(persons.filter(n => n.id !== personToUpdate.id))\r\n        })\r\n    }\r\n    setNewName('')\r\n    setNewNumber('')    \r\n  }\r\n  console.log(\"people \",persons)\r\n  let filteredpersons = persons.filter(p =>\r\n    p.name.toLowerCase().includes(filter.toLowerCase()))\r\n  return (\r\n    <div>\r\n      <h2>Phonebook</h2>\r\n      <Notification message={message}/>\r\n      <Filter filter={filter} handleFilterChange={handleFilterChange}/>\r\n      <h3>add a new</h3>\r\n      <PersonForm newName={newName} newNumber={newNumber} addPerson={addPerson} handleNameChange={handleNameChange} handleNumberChange={handleNumberChange}/>   \r\n      <h2>Numbers</h2>\r\n      <Persons people={filteredpersons} handleDeletePerson={handleDeletePerson}/>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default App"],"mappings":"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"},"metadata":{},"sourceType":"module"}